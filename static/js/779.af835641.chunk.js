"use strict";(self.webpackChunkclouding_frontend=self.webpackChunkclouding_frontend||[]).push([[779],{52779:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var a=s(47313),n=s(58467),o=s(10807),l=s(46417);const i=e=>{let{item:t,setEditedItemId:s,archiveMutation:a}=e;return(0,l.jsxs)("div",{className:"tableRow",children:[(0,l.jsx)("div",{className:"tableCell py-3 ps-2 roundedLeft",children:(0,l.jsx)("p",{children:null===t||void 0===t?void 0:t.name})}),(0,l.jsx)("div",{className:"tableCell",children:(0,l.jsx)("p",{children:t.workflow_name})}),(0,l.jsx)("div",{className:"tableCell",children:(0,l.jsx)("p",{className:"status-default",style:{backgroundColor:t.stage.color},children:t.stage.name})}),(0,l.jsx)("div",{className:"tableCell",children:(0,l.jsx)("p",{className:"status-default",style:{backgroundColor:t.environment.color},children:t.environment.name})}),(0,l.jsx)("div",{className:"tableCell",children:(0,l.jsx)("p",{children:t.description})}),(0,l.jsx)("p",{className:"tableCell",children:t.last_used}),(0,l.jsx)("div",{className:"tableCell roundedRight",children:(0,l.jsx)(o.Cg,{itemId:t.id,name:"parameter",setEditedItemId:s,archiveMutation:a})})]})},r=e=>{let{listAgents:t,isSuccess:s,isLoading:a,totalPage:n,setEditedItemId:r,archiveMutation:c}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"tableOuter",children:[(0,l.jsxs)("div",{className:"tableContainer",children:[(0,l.jsxs)("div",{className:"tableHead",children:[(0,l.jsx)("div",{className:"tableCell pb-4",children:"Name"}),(0,l.jsx)("div",{className:"tableCell",children:"Workflow Name"}),(0,l.jsx)("div",{className:"tableCell",children:"Stage"}),(0,l.jsx)("div",{className:"tableCell",children:"Environment"}),(0,l.jsx)("div",{className:"tableCell",children:"Description"}),(0,l.jsx)("div",{className:"tableCell",children:"Last used"}),(0,l.jsx)("div",{className:"tableCell"})]}),s&&t.map((e=>(0,l.jsx)(i,{item:e,setEditedItemId:r,archiveMutation:c},e.id)))]}),s&&0===t.length&&(0,l.jsx)(o.Jd,{})]}),(s&&0!==t.length||a)&&(0,l.jsx)(o.tl,{pageCount:n||5})]})};var c=s(75627),d=s(63849),m=s(31616);const u=e=>{let{title:t="",method:s,handleSubmit:a,onLoading:n,onClose:i,stages:r,environments:u,workflows:h}=e;const v=r.map((e=>e.name)),p=u.map((e=>e.name)),g=h.map((e=>e.workflow_name));return(0,l.jsx)(c.RV,{...s,children:(0,l.jsxs)("form",{onSubmit:s.handleSubmit(a),children:[(0,l.jsxs)(o.ck,{title:t,className:"pb-4 borderBottom",classTitle:"title-green",children:[(0,l.jsx)(o.LX,{name:"name",label:"Agent name",type:"text",placeholder:"Enter agent name",tooltip:"Agent name is required"}),(0,l.jsx)(o.LX,{name:"description",label:"Description",type:"text",placeholder:"Enter describtion",tooltip:"Please enter correct describtion format"}),(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(m.Z,{sm:12,md:6,children:(0,l.jsx)(o.Jm,{name:"stage",data:v,defaultValue:"Select stage",label:"Stage",tooltip:"stage is required"})}),(0,l.jsx)(m.Z,{sm:12,md:6,children:(0,l.jsx)(o.Jm,{name:"environment",data:p,defaultValue:"Select environment",label:"Environment",tooltip:"Environment is required"})})]})]}),(0,l.jsx)(o.ck,{title:"Repository link",className:"py-4 borderBottom",classTitle:"title-purple",children:(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(m.Z,{sm:12,md:6,children:(0,l.jsx)(o.Jm,{label:"Workflow name",name:"workflow_name",placeholder:"Enter workflow name",data:g,tooltip:"Workflow name is required"})}),(0,l.jsx)(m.Z,{sm:12,md:6,children:(0,l.jsx)(o.Jm,{name:"platform",data:["Github Actions"],defaultValue:"Select platform",label:"Platform",tooltip:"Platform is required"})})]})}),(0,l.jsxs)("div",{className:"pt-5 d-flex justify-content-end align-items-center",children:[(0,l.jsx)("div",{children:(0,l.jsx)("p",{onClick:i,className:"button-white me-2",children:"Cancel"})}),(0,l.jsx)("div",{children:(0,l.jsx)(o.Z6,{threeDotsWidth:"20",threeDotsHeight:"20",type:"submit",className:"button px-4",value:"Done",notMaxWidth:!0,loading:!1})})]})]})})};var h=s(42161),v=s(23560);const p=e=>{let{project_id:t,onClose:s,stages:a,environments:n,workflows:o,setShowConfirmation:i,setReturnToken:r}=e;const{addAgentMutation:d}=(0,h.ui)(t),m=(0,c.cI)({});return(0,l.jsx)(u,{title:"Add Agent",method:m,handleSubmit:e=>{console.log("AddForm data",e);const a={data:e,project_id:t};d.mutate(a,{onSuccess:e=>{var t;s(),r(null===(t=e.data)||void 0===t?void 0:t.api_token),i(!0),console.log("data",e)},onError:e=>{console.log("error",e.response.data.error),v.Am.error(e.response.data.error,{autoClose:5e3})}})},onLoading:!1,onClose:s,stages:a,environments:n,workflows:o})};var g=s(13489);const j=e=>{let{project_id:t,onClose:s,editedItemId:n,stages:o,environments:i,workflows:r}=e;const{editAgentMutation:d}=(0,h.ui)(t),m=(0,c.cI)({});return(0,a.useEffect)((()=>{(async()=>{try{const e=(await(0,g.q)(t,n)).data.agent,s={name:e.name,description:e.description,environment_id:e.Environment.ID,environment:e.Environment.name,stage_id:e.Stage.ID,stage:e.Stage.name,workflow_name:e.workflow_name};m.reset(s)}catch(e){console.error("Error fetching agent data:",e)}})()}),[n,m]),(0,l.jsx)(u,{title:"Edit Agent",method:m,handleSubmit:e=>{const a={data:e,agent_id:n,project_id:t};d.mutate(a,{onSuccess:()=>{s()},onError:e=>{console.log("error",e.response.data.error),v.Am.error(e.response.data.error,{autoClose:5e3})}})},onLoading:!1,stages:o,environments:i,workflows:r,onClose:()=>{}})},x=()=>{const{id:e}=(0,n.UO)(),[t,s]=(0,a.useState)(!1),[i,c]=(0,a.useState)(void 0),[d,m]=(0,a.useState)(!1),[u,v]=(0,a.useState)(""),{stages:x,environments:f,listWorkflows:b}=(0,h.f_)(e),{listAgents:w,pagination:C,isLoading:N,isSuccess:k}=(0,h.ui)(e),{archivedList:S,isSuccess:A,isLoading:y,search:E,handleSearch:I,archiveMutation:_,unarchiveMutation:L}=(0,h.bm)({archivedAgent:{listArchivedAPI:g.qX,archiveAPI:g.hG,unarchiveAPI:g.Uv,keyArchivistList:"agent-archivist-list",keyList:"agents",title:"Agent",project_id:e}}),P=()=>{s(!1),c(void 0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o.u_,{outerClassName:"outerModal",visible:t||"undefined"!==typeof i||d,onClose:P,children:[t&&(0,l.jsx)(p,{project_id:e,onClose:()=>s(!1),stages:x,environments:f,setShowConfirmation:m,setReturnToken:v,workflows:b}),"undefined"!==typeof i&&(0,l.jsx)(j,{project_id:e,editedItemId:i,onClose:()=>c(void 0),stages:x,environments:f,workflows:b}),d&&(0,l.jsx)(o.g2,{title:"Agent created successfully!",message:"Please copy the token below and keep it safe. You won't be able to see it again.",content:"".concat(u),contentBtnSubmit:"Done",onClose:()=>m(!1),handleSubmit:()=>{m(!1),P()}})]}),(0,l.jsx)(o.Zb,{title:"".concat(k?null===C||void 0===C?void 0:C.total:"0"," Agents"),classTitle:"title-purple",head:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.HK,{placeholder:"Search by name"}),(0,l.jsxs)("div",{className:"d-flex",children:[(0,l.jsx)(o.i6,{handleClickAdd:()=>s(!0),titleButton:"Add Agent",className:"me-2"}),(0,l.jsx)(o.kg,{title:"Archived Agents",archivedList:S,isSuccess:A,isLoading:y,search:E,handleSearch:I,unarchiveMutation:L})]})]}),children:(0,l.jsx)(r,{listAgents:w,isSuccess:k,isLoading:N,totalPage:null===C||void 0===C?void 0:C.totalPage,setEditedItemId:c,archiveMutation:_})})]})}},31616:(e,t,s)=>{s.d(t,{Z:()=>c});var a=s(46123),n=s.n(a),o=s(47313),l=s(68524),i=s(46417);const r=o.forwardRef(((e,t)=>{const[{className:s,...a},{as:o="div",bsPrefix:r,spans:c}]=function(e){let{as:t,bsPrefix:s,className:a,...o}=e;s=(0,l.vE)(s,"col");const i=(0,l.pi)(),r=(0,l.zG)(),c=[],d=[];return i.forEach((e=>{const t=o[e];let a,n,l;delete o[e],"object"===typeof t&&null!=t?({span:a,offset:n,order:l}=t):a=t;const i=e!==r?"-".concat(e):"";a&&c.push(!0===a?"".concat(s).concat(i):"".concat(s).concat(i,"-").concat(a)),null!=l&&d.push("order".concat(i,"-").concat(l)),null!=n&&d.push("offset".concat(i,"-").concat(n))})),[{...o,className:n()(a,...c,...d)},{as:t,bsPrefix:s,spans:c}]}(e);return(0,i.jsx)(o,{...a,ref:t,className:n()(s,!c.length&&r)})}));r.displayName="Col";const c=r},63849:(e,t,s)=>{s.d(t,{Z:()=>c});var a=s(46123),n=s.n(a),o=s(47313),l=s(68524),i=s(46417);const r=o.forwardRef(((e,t)=>{let{bsPrefix:s,className:a,as:o="div",...r}=e;const c=(0,l.vE)(s,"row"),d=(0,l.pi)(),m=(0,l.zG)(),u="".concat(c,"-cols"),h=[];return d.forEach((e=>{const t=r[e];let s;delete r[e],null!=t&&"object"===typeof t?({cols:s}=t):s=t;const a=e!==m?"-".concat(e):"";null!=s&&h.push("".concat(u).concat(a,"-").concat(s))})),(0,i.jsx)(o,{ref:t,...r,className:n()(a,c,...h)})}));r.displayName="Row";const c=r}}]);