"use strict";(self.webpackChunkclouding_frontend=self.webpackChunkclouding_frontend||[]).push([[161],{42161:(e,i,a)=>{a.d(i,{ui:()=>I,bm:()=>F,eC:()=>Y,Um:()=>j,y3:()=>P,Cx:()=>K,Ry:()=>k,jK:()=>g,w1:()=>S,NJ:()=>z,BR:()=>D,a0:()=>M,OE:()=>T,o8:()=>r,jC:()=>u,BS:()=>d,Gt:()=>A,B1:()=>q,oP:()=>_,f_:()=>h,S3:()=>p,rS:()=>N});var s=a(79888),t=a(97032),o=a(13489),n=a(23560);const r=e=>{const{data:i,isSuccess:a,isLoading:r}=(0,s.a)({queryKey:["organizations"],queryFn:()=>(0,o.$9)(),select:e=>e.data.organization}),u=(0,t.D)((e=>(0,o.WV)(e.org_id,e.data)),{onSuccess:()=>{n.Am.success("Organization updated successfully",{autoClose:5e3})},onError:e=>{console.log("error",e.response.data.error),n.Am.error(e.response.data.error,{autoClose:5e3})}});return{data:i,isSuccess:a,isLoading:r,editOrganizationMutation:u}},u=(e,i)=>{const{data:a,isSuccess:t,isLoading:n}=(0,s.a)({queryKey:["organization-dashboard",e,i],queryFn:()=>(0,o.nG)(e,i),staleTime:1e4,select:e=>(e=>{var i;return{logs:null===e||void 0===e||null===(i=e.logs_with_granularity)||void 0===i?void 0:i.map((e=>({bucket:e.period_start,averageDuration:e.avg_duration_in_period,paramUpdateCount:e.count})))}})(e.data)});return{logs:null===a||void 0===a?void 0:a.logs,isSuccess:t,isLoading:n}},d=e=>{const{data:i,isSuccess:a,isLoading:t}=(0,s.a)({queryKey:["organization-dashboard",e],queryFn:()=>(0,o.bb)(e),staleTime:1e4,select:e=>(e=>({total:{project_count:null===e||void 0===e?void 0:e.project_count,active_projects_count:null===e||void 0===e?void 0:e.active_projects_count,pending_projects_count:null===e||void 0===e?void 0:e.pending_projects_count,user_count:null===e||void 0===e?void 0:e.user_count,workflow_count:null===e||void 0===e?void 0:e.workflow_count,avg_duration:null===e||void 0===e?void 0:e.avg_duration,total_updated:null===e||void 0===e?void 0:e.total_updated,total_agent_actions:null===e||void 0===e?void 0:e.total_agent_actions,total_updated_this_month:null===e||void 0===e?void 0:e.total_updated_this_month,total_agent_actions_this_month:null===e||void 0===e?void 0:e.total_agent_actions_this_month}}))(e.data)});return{total:null===i||void 0===i?void 0:i.total,isSuccess:a,isLoading:t}};var l=a(47313),c=a(83713);a(18477);var v=a(14052);const m={page:1,limit:10},g=()=>{const e=(0,v.NL)(),{queryString:i,setQueryString:a}=(0,c.Z)(),{page:r,limit:u}=i;(0,l.useEffect)((()=>{r&&u||a(m)}),[u,r,i,a]);const d=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.projects.map((e=>({id:null===e||void 0===e?void 0:e.id,createdAt:null===e||void 0===e?void 0:e.CreatedAt,name:null===e||void 0===e?void 0:e.name,color:null===e||void 0===e?void 0:e.color,usersCount:null===e||void 0===e?void 0:e.users_count,repoUrl:null===e||void 0===e?void 0:e.RepoURL,description:null===e||void 0===e?void 0:e.description,address:null===e||void 0===e?void 0:e.address,currentSprint:null===e||void 0===e?void 0:e.CurrentSprint,startDate:null===e||void 0===e?void 0:e.startDate,status:null===e||void 0===e?void 0:e.status,autoUpdate:null===e||void 0===e?void 0:e.auto_update})));return{pagination:{total:i.length,currentPage:r,totalPage:Math.ceil(i.length/u),limit:u},projects:i}}),[]),{data:g,isSuccess:y,isLoading:p}=(0,s.a)({queryKey:["projects",i],queryFn:()=>(0,o.Yj)(i),staleTime:1e4,select:e=>d(e.data),enabled:!!r&&!!u}),h=(0,t.D)((e=>(0,o.B)(e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["projects"]}),n.Am.success("Add project successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),_=(0,t.D)((e=>(0,o.NV)(e.id,e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["projects"]}),n.Am.success("Edit project successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),S=(0,t.D)((e=>(0,o.tq)(e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["projects"]}),n.Am.success("Apply parameters successfully, waiting for agent pull")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listProjects:null===g||void 0===g?void 0:g.projects,pagination:null===g||void 0===g?void 0:g.pagination,isSuccess:y,isLoading:p,addProjectMutation:h,editProjectMutation:_,applyParametersMutation:S}},y={page:1,limit:10},p=e=>{const i=(0,v.NL)(),{queryString:a,setQueryString:r}=(0,c.Z)(),{page:u,limit:d}=a;(0,l.useEffect)((()=>{u&&d||r(y)}),[d,u,a,r]);const m=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.users.map((e=>({id:e.id,name:e.name,username:e.username,email:e.email,role:e.role,phone:null===e||void 0===e?void 0:e.phone})));return{pagination:{total:i.length,currentPage:1,totalPage:Math.ceil(i.length/10),limit:10},users:i}}),[]),{data:g,isSuccess:p,isLoading:h}=(0,s.a)({queryKey:["projects","overview",e],queryFn:()=>(0,o.kh)(e),staleTime:1e4,select:e=>m(e.data),enabled:!!u&&!!d}),_=(0,t.D)((e=>(0,o.y6)(e.project_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["users",a]}),n.Am.success("Add user successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),S=(0,t.D)((e=>(0,o.sU)(e.project_id,e.user_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["users",a]}),n.Am.success("Edit user successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),A=(0,t.D)((e=>(0,o.VH)(e.project_id,e.user_id)),{onSuccess:()=>{i.invalidateQueries({queryKey:["users",a]}),n.Am.success("Remove user successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listUsers:null===g||void 0===g?void 0:g.users,pagination:null===g||void 0===g?void 0:g.pagination,isSuccess:p,isLoading:h,addUserMutation:_,editUserMutation:S,removeUserMutation:A}},h=e=>{var i,a,t,n;const{data:r,isSuccess:u}=(0,s.a)({queryKey:["projects","overview",e],queryFn:()=>(0,o.kh)(e),select:e=>e.data}),d={id:null===r||void 0===r?void 0:r.overview.ID,name:null===r||void 0===r?void 0:r.overview.name,description:null===r||void 0===r?void 0:r.overview.description,status:null===r||void 0===r?void 0:r.overview.status,start_at:null===r||void 0===r?void 0:r.overview.start_at,address:null===r||void 0===r?void 0:r.overview.address,current_sprint:null===r||void 0===r?void 0:r.overview.current_sprint,repo_url:null===r||void 0===r?void 0:r.overview.repo_url,member_count:null===r||void 0===r?void 0:r.users.length,auto_update:null===r||void 0===r?void 0:r.overview.auto_update},l=null===r||void 0===r?void 0:r.users;return{overview:d,stages:null===r||void 0===r||null===(i=r.overview)||void 0===i?void 0:i.stages.map((e=>({id:null===e||void 0===e?void 0:e.ID,name:null===e||void 0===e?void 0:e.name,description:null===e||void 0===e?void 0:e.description,color:null===e||void 0===e?void 0:e.color}))),environments:null===r||void 0===r||null===(a=r.overview)||void 0===a?void 0:a.environments.map((e=>({id:null===e||void 0===e?void 0:e.ID,name:null===e||void 0===e?void 0:e.name,description:null===e||void 0===e?void 0:e.description,color:null===e||void 0===e?void 0:e.color}))),usersList:l,isSuccess:u,listWorkflows:null===r||void 0===r||null===(t=r.overview)||void 0===t||null===(n=t.workflows)||void 0===n?void 0:n.map((e=>({id:null===e||void 0===e?void 0:e.workflow_id,workflow_name:null===e||void 0===e?void 0:e.name,path:null===e||void 0===e?void 0:e.path,state:null===e||void 0===e?void 0:e.state,url_path:"https://".concat(null===r||void 0===r?void 0:r.overview.repo_url,"/blob/main/").concat(null===e||void 0===e?void 0:e.path)})))}},_=e=>{const{data:i,isSuccess:a,isLoading:t}=(0,s.a)({queryKey:["projects","workflows",e],queryFn:()=>(0,o.HJ)(e),select:e=>n(e.data.data)}),n=e=>{var i;const a=null===e||void 0===e?void 0:e.repo_url,s=null===e||void 0===e||null===(i=e.workflows)||void 0===i?void 0:i.map((e=>({id:null===e||void 0===e?void 0:e.workflow_id,workflow_name:null===e||void 0===e?void 0:e.name,path:null===e||void 0===e?void 0:e.path,state:null===e||void 0===e?void 0:e.state,url_path:"https://".concat(a,"/blob/main/").concat(null===e||void 0===e?void 0:e.path)})));return console.log("useProjectListWorkflow listWorkflows : ",s),s};return{isSuccess:a,listWorkflows:i,isLoadingListWorkflows:t,totalPage:null===i||void 0===i?void 0:i.length}},S=e=>{let{archivedProjects:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m}=i,[g,y]=(0,l.useState)(""),p=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.map((e=>({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name,archiver:null===e||void 0===e?void 0:e.archived_by,archivedAt:null===e||void 0===e?void 0:e.archived_at})))),[]),{data:h,isSuccess:_,isLoading:S}=(0,s.a)({queryKey:[c],queryFn:()=>o(),select:e=>p(e.data.projects)}),A=(0,l.useMemo)((()=>{if(!h)return[];return h.filter((e=>e.name.toLowerCase().includes(g.toLowerCase())))}),[h,g]),q=(0,l.useCallback)((e=>{y(e)}),[]),f=(0,t.D)((async e=>u(e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}}),L=(0,t.D)((e=>r(e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:A,isSuccess:_,isLoading:S,search:g,handleSearch:q,archiveMutation:L,unarchiveMutation:f}},A=(e,i)=>{const{data:a,isSuccess:t,isLoading:n}=(0,s.a)({queryKey:["project-dashboard",e,i],queryFn:()=>(0,o.Oj)(e,i),staleTime:1e4,select:e=>(e=>{var i;return{logs:null===e||void 0===e||null===(i=e.logs_with_granularity)||void 0===i?void 0:i.map((e=>({bucket:e.period_start,averageDuration:e.avg_duration_in_period,paramUpdateCount:e.count})))}})(e.data)});return{logs:null===a||void 0===a?void 0:a.logs,isSuccess:t,isLoading:n}},q=e=>{const{data:i,isSuccess:a,isLoading:t}=(0,s.a)({queryKey:["project-dashboard",e],queryFn:()=>(0,o.Rg)(e),staleTime:1e4,select:e=>(e=>({total:{count_total_updated:null===e||void 0===e?void 0:e.count_total_updated,count_total_agent_actions:null===e||void 0===e?void 0:e.count_total_agent_actions,count_agent_actions_this_month:null===e||void 0===e?void 0:e.count_agent_actions_this_month,count_agent_actions_this_week:null===e||void 0===e?void 0:e.count_agent_actions_this_week,count_updated_this_month:null===e||void 0===e?void 0:e.count_updated_this_month,count_updated_this_week:null===e||void 0===e?void 0:e.count_updated_this_week,count_workflows:null===e||void 0===e?void 0:e.count_workflows,avg_duration_of_workflows_current_month:null===e||void 0===e?void 0:e.avg_duration_of_workflows_current_month}}))(e.data)});return{total:null===i||void 0===i?void 0:i.total,isSuccess:a,isLoading:t}};var f=a(58467),L=a(70816),w=a.n(L);const C={page:1,limit:10},K=e=>{const{id:i}=(0,f.UO)();e||(e=i);const a=(0,v.NL)(),{queryString:r,setQueryString:u}=(0,c.Z)(),{page:d,limit:m}=r;(0,l.useEffect)((()=>{d&&m||u(C)}),[m,d,r,u]);const g=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.map((e=>({id:e.ID,name:e.name,value:e.value,stage:{name:e.stage.name,color:e.stage.color},environment:{name:e.environment.name,color:e.environment.color},createdAt:w()(e.CreatedAt).format("DD/MM/YYYY"),updatedAt:w()(e.UpdatedAt).format("DD/MM/YYYY"),isApplied:e.is_applied})));return{pagination:{total:null===i||void 0===i?void 0:i.length,currentPage:1,totalPage:Math.ceil(i.length/10),limit:10},parameters:i}}),[]),{data:y,isSuccess:p,isLoading:h}=(0,s.a)({queryKey:["projects",r],queryFn:()=>(0,o.M5)(e),staleTime:1e4,select:e=>g(e.data.parameters),enabled:!!d&&!!m}),_=(0,t.D)((e=>(0,o.bM)(e.project_id,e.data)),{onSuccess:()=>{a.invalidateQueries({queryKey:["parameters"]}),n.Am.success("Add parameter successfully! Start rerun cicd to apply changes.")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),S=(0,t.D)((e=>(0,o.VM)(e.project_id,e.parameter_id,e.data)),{onSuccess:e=>{a.invalidateQueries({queryKey:["parameters"]}),console.log("editParameterMutation response:",e);const i=e.data.message;n.Am.success(i,{autoClose:1e4})},onError:e=>{n.Am.error(e.response.data.message,{autoClose:1e4})}}),A=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.map((e=>({id:e.ID,name:e.name,description:e.description,color:e.color})))),[]),{data:q}=(0,s.a)({queryKey:["stages"],queryFn:()=>(0,o.yI)(),select:e=>A(e.data.stages),staleTime:1e4,enabled:!0}),L=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.map((e=>({id:e.ID,name:e.name,description:e.description,color:e.color})))),[]),{data:K}=(0,s.a)({queryKey:["environments"],queryFn:()=>(0,o.hF)(),select:e=>L(e.data.environments),staleTime:1e4,enabled:!0}),k=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.map((e=>({id:e.ID,name:e.name,description:e.description,color:e.color})))),[]),{data:b}=(0,s.a)({queryKey:["versions"],queryFn:()=>(0,o.yQ)(e),select:e=>k(e.data.versions),staleTime:1e4,enabled:!0});return{listParameters:null===y||void 0===y?void 0:y.parameters,pagination:null===y||void 0===y?void 0:y.pagination,stages:q,environments:K,versions:b,isSuccess:p,isLoading:h,addParameterMutation:_,editParameterMutation:S}},k=e=>{let{archivedParameters:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m,project_id:g}=i,[y,p]=(0,l.useState)(""),h=(0,l.useCallback)((e=>e.map((e=>({id:null===e||void 0===e?void 0:e.ID,name:null===e||void 0===e?void 0:e.name,archiver:null===e||void 0===e?void 0:e.archived_by,archivedAt:null===e||void 0===e?void 0:e.archived_at})))),[]),{data:_,isSuccess:S,isLoading:A}=(0,s.a)({queryKey:[c],queryFn:()=>o(g),select:e=>h(e.data.parameters)}),q=(0,l.useMemo)((()=>{if(!_)return[];return _.filter((e=>null===e||void 0===e?void 0:e.name.toLowerCase().includes(y.toLowerCase())))}),[_,y]),f=(0,l.useCallback)((e=>{p(e)}),[]),L=(0,t.D)((async e=>u(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," unarchived successfully"))}}),w=(0,t.D)((e=>r(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:q,isSuccess:S,isLoading:A,search:y,handleSearch:f,archiveMutation:w,unarchiveMutation:L}},b={page:1,limit:10},D=e=>{const i=(0,v.NL)(),{queryString:a,setQueryString:r}=(0,c.Z)(),{page:u,limit:d}=a;(0,l.useEffect)((()=>{u&&d||r(b)}),[d,u,a,r]);const m=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.stages.map((e=>({name:null===e||void 0===e?void 0:e.name,id:null===e||void 0===e?void 0:e.ID,description:null===e||void 0===e?void 0:e.description})));return{pagination:{total:i.length,currentPage:1,totalPage:Math.ceil(i.length/10),limit:10},stages:i}}),[]),{data:g,isSuccess:y,isLoading:p}=(0,s.a)({queryKey:["stages",a],queryFn:()=>(0,o.a3)(e),staleTime:1e4,select:e=>m(e.data.data),enabled:!!u&&!!d}),h=(0,t.D)((e=>(0,o.CI)(e.project_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["stages"]}),n.Am.success("Add stage successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),_=(0,t.D)((e=>(0,o.Ef)(e.project_id,e.stage_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["stages"]}),n.Am.success("Edit stage successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listStages:null===g||void 0===g?void 0:g.stages,pagination:null===g||void 0===g?void 0:g.pagination,isSuccess:y,isLoading:p,addStageMutation:h,editStageMutation:_}},M=e=>{let{archivedStage:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m,project_id:g}=i,[y,p]=(0,l.useState)(""),h=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.stages.map((e=>({id:null===e||void 0===e?void 0:e.ID,name:null===e||void 0===e?void 0:e.name,archiver:null===e||void 0===e?void 0:e.archived_by,archivedAt:null===e||void 0===e?void 0:e.archived_at})))),[]),{data:_,isSuccess:S,isLoading:A}=(0,s.a)({queryKey:[c],queryFn:()=>o(g),select:e=>h(e.data.data)}),q=(0,l.useMemo)((()=>{if(!_)return[];return _.filter((e=>null===e||void 0===e?void 0:e.name.toLowerCase().includes(y.toLowerCase())))}),[_,y]),f=(0,l.useCallback)((e=>{p(e)}),[]),L=(0,t.D)((async e=>u(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," unarchived successfully"))}}),w=(0,t.D)((e=>r(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:q,isSuccess:S,isLoading:A,search:y,handleSearch:f,archiveMutation:w,unarchiveMutation:L}},Q={page:1,limit:10},j=e=>{const i=(0,v.NL)(),{queryString:a,setQueryString:r}=(0,c.Z)(),{page:u,limit:d}=a;(0,l.useEffect)((()=>{u&&d||r(Q)}),[d,u,a,r]);const m=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.environments.map((e=>({name:null===e||void 0===e?void 0:e.name,id:null===e||void 0===e?void 0:e.ID,description:null===e||void 0===e?void 0:e.description})));return{pagination:{total:i.length,currentPage:1,totalPage:Math.ceil(i.length/10),limit:10},environments:i}}),[]),{data:g,isSuccess:y,isLoading:p}=(0,s.a)({queryKey:["environments",a],queryFn:()=>(0,o.R5)(e),staleTime:1e4,select:e=>m(e.data.data),enabled:!!u&&!!d}),h=(0,t.D)((e=>(0,o.e3)(e.project_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["environments"]}),n.Am.success("Add environment successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),_=(0,t.D)((e=>(0,o.Gx)(e.project_id,e.environment_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["environments"]}),n.Am.success("Edit environment successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listEnvironments:null===g||void 0===g?void 0:g.environments,pagination:null===g||void 0===g?void 0:g.pagination,isSuccess:y,isLoading:p,addEnvironmentMutation:h,editEnvironmentMutation:_}},P=e=>{let{archivedEnvironment:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m,project_id:g}=i,[y,p]=(0,l.useState)(""),h=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.environments.map((e=>({id:null===e||void 0===e?void 0:e.ID,name:null===e||void 0===e?void 0:e.name,archiver:null===e||void 0===e?void 0:e.archived_by,archivedAt:null===e||void 0===e?void 0:e.archived_at})))),[]),{data:_,isSuccess:S,isLoading:A}=(0,s.a)({queryKey:[c],queryFn:()=>o(g),select:e=>h(e.data.data)}),q=(0,l.useMemo)((()=>{if(!_)return[];return _.filter((e=>null===e||void 0===e?void 0:e.name.toLowerCase().includes(y.toLowerCase())))}),[_,y]),f=(0,l.useCallback)((e=>{p(e)}),[]),L=(0,t.D)((async e=>u(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," unarchived successfully"))}}),w=(0,t.D)((e=>r(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:q,isSuccess:S,isLoading:A,search:y,handleSearch:f,archiveMutation:w,unarchiveMutation:L}},E={page:1,limit:10},I=e=>{const i=(0,v.NL)(),{queryString:a,setQueryString:r}=(0,c.Z)(),{page:u,limit:d}=a;(0,l.useEffect)((()=>{u&&d||r(E)}),[d,u,a,r]);const m=(0,l.useCallback)((e=>{const i=null===e||void 0===e?void 0:e.map((e=>({name:null===e||void 0===e?void 0:e.name,id:null===e||void 0===e?void 0:e.id,description:null===e||void 0===e?void 0:e.description,stage:{id:e.Stage.ID,name:e.Stage.name},environment:{id:e.Environment.ID,name:e.Environment.name},workflow_name:e.workflow_name})));return{pagination:{total:i.length,currentPage:1,totalPage:Math.ceil(i.length/10),limit:10},agents:i}}),[]),{data:g,isSuccess:y,isLoading:p}=(0,s.a)({queryKey:["agents",a],queryFn:()=>(0,o._G)(e),staleTime:1e4,select:e=>m(e.data.agents),enabled:!!u&&!!d}),h=(0,t.D)((e=>(console.log("addAgentMutation data",e),(0,o.o0)(e.project_id,e.data))),{onSuccess:e=>(i.invalidateQueries({queryKey:["agents"]}),n.Am.success("Add agent successfully"),e),onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),_=(0,t.D)((e=>(0,o.K2)(e.project_id,e.agent_id,e.data)),{onSuccess:()=>{i.invalidateQueries({queryKey:["agents"]}),n.Am.success("Edit agent successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),S=(0,t.D)((e=>(0,o.Lr)(e)),{onSuccess:()=>{i.invalidateQueries({queryKey:["agents"]}),n.Am.success("Delete agent successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listAgents:null===g||void 0===g?void 0:g.agents,pagination:null===g||void 0===g?void 0:g.pagination,isSuccess:y,isLoading:p,addAgentMutation:h,editAgentMutation:_,deleteAgentMutation:S}},F=e=>{let{archivedAgent:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m,project_id:g}=i,[y,p]=(0,l.useState)(""),h=(0,l.useCallback)((e=>null===e||void 0===e?void 0:e.map((e=>({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name,image:null===e||void 0===e?void 0:e.avatar_url,archiver:null===e||void 0===e?void 0:e.archived_by,archivedAt:null===e||void 0===e?void 0:e.archived_at})))),[]),{data:_,isSuccess:S,isLoading:A}=(0,s.a)({queryKey:[c],queryFn:()=>o(g),select:e=>h(e.data.agents)}),q=(0,l.useMemo)((()=>{if(!_)return[];return _.filter((e=>null===e||void 0===e?void 0:e.name.toLowerCase().includes(y.toLowerCase())))}),[_,y]),f=(0,l.useCallback)((e=>{p(e)}),[]),L=(0,t.D)((async e=>u(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," unarchived successfully"))}}),w=(0,t.D)((e=>r(g,e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:q,isSuccess:S,isLoading:A,search:y,handleSearch:f,archiveMutation:w,unarchiveMutation:L}},N=e=>{const{data:i,isSuccess:a,isLoading:t}=(0,s.a)({queryKey:["organizations"],queryFn:()=>(0,o.Ac)(e),select:e=>n(e.data.data)}),n=e=>[...null===e||void 0===e?void 0:e.agent_logs,...null===e||void 0===e?void 0:e.project_logs].map((e=>{const i=e.hasOwnProperty("agent_id"),a=i?e.agent.name:e.user.username;return{...e,[a]:e[i?"agent":"user"].name,actor:a}})).sort(((e,i)=>new Date(i.CreatedAt)-new Date(e.CreatedAt)));return{data:i,isSuccess:a,isLoading:t}},U={page:1,limit:10},T=()=>{const e=(0,v.NL)(),{queryString:i,setQueryString:a}=(0,c.Z)(),{page:r,limit:u}=i;(0,l.useEffect)((()=>{r&&u||a(U)}),[u,r,i,a]);const d=(0,l.useCallback)((e=>{var i;const a=null===e||void 0===e||null===(i=e.users)||void 0===i?void 0:i.map((e=>({id:null===e||void 0===e?void 0:e.id,username:null===e||void 0===e?void 0:e.username,phone:null===e||void 0===e?void 0:e.phone,email:null===e||void 0===e?void 0:e.email,is_organization_admin:null===e||void 0===e?void 0:e.is_organization_admin})));return{pagination:{total:a.length,currentPage:1,totalPage:Math.ceil(a.length/10),limit:10},users:a}}),[]),{data:m,isSuccess:g,isLoading:y}=(0,s.a)({queryKey:["users",i],queryFn:()=>(0,o.VD)(i),staleTime:1e4,select:e=>d(e.data.data),enabled:!!r&&!!u}),p=(0,t.D)((e=>(0,o.cn)(e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["users",i]}),n.Am.success("Add user successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),h=(0,t.D)((e=>(0,o.uz)(e.id,e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["users",i]}),n.Am.success("Edit user successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listUsers:null===m||void 0===m?void 0:m.users,pagination:null===m||void 0===m?void 0:m.pagination,isSuccess:g,isLoading:y,addUserMutation:p,editUserMutation:h}},R={page:1,limit:10};function z(){const e=(0,v.NL)(),{queryString:i,setQueryString:a}=(0,c.Z)(),{page:r,limit:u}=i;(0,l.useEffect)((()=>{r&&u||a(R)}),[u,r,i,a]);const d=(0,l.useCallback)((e=>({pagination:{total:3,currentPage:1,totalPage:1,limit:10},roles:e.roles.map((e=>({id:e.id,name:e.name,description:e.description,usersCount:e.user_count,permissions:e.permissions_count})))})),[]),{data:m,isSuccess:g,isLoading:y}=(0,s.a)({queryKey:["roles",i],queryFn:()=>(0,o.oR)(i),staleTime:1e4,select:e=>d(e.data.data),enabled:!!r&&!!u}),p=(0,t.D)((e=>(0,o._d)(e)),{onSuccess:()=>{e.invalidateQueries({queryKey:["roles",i]}),n.Am.success("Add role successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}}),h=(0,t.D)(((e,i)=>(0,o.Aq)(e,i)),{onSuccess:()=>{e.invalidateQueries({queryKey:["roles",i]}),n.Am.success("Edit role successfully")},onError:e=>{n.Am.error(e.response.data.message,{autoClose:5e3})}});return{listRoles:null===m||void 0===m?void 0:m.roles,pagination:null===m||void 0===m?void 0:m.pagination,isSuccess:g,isLoading:y,addRoleMutation:p,editRoleMutation:h}}const Y=e=>{let{archivedObject:i={}}=e;const a=(0,v.NL)(),{listArchivedAPI:o,archiveAPI:r,unarchiveAPI:u,keyList:d,keyArchivistList:c,title:m}=i,[g,y]=(0,l.useState)(""),p=(0,l.useCallback)((e=>e.map((e=>({id:e.id,name:e.username,archiver:e.archived_by,archivedAt:e.archived_at})))),[]),{data:h,isSuccess:_,isLoading:S}=(0,s.a)({queryKey:[c],queryFn:()=>o(),select:e=>p(e.data.data.users)}),A=(0,l.useMemo)((()=>{if(!h)return[];return h.filter((e=>e.name.toLowerCase().includes(g.toLowerCase())))}),[h,g]),q=(0,l.useCallback)((e=>{y(e)}),[]),f=(0,t.D)((async e=>u(e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," unarchived successfully"))}}),L=(0,t.D)((e=>r(e)),{onSuccess:()=>{a.invalidateQueries({queryKey:[d]}),a.invalidateQueries({queryKey:[c]}),n.Am.success("".concat(m," archived successfully"))}});return{archivedList:A,isSuccess:_,isLoading:S,search:g,handleSearch:q,archiveMutation:L,unarchiveMutation:f}}}}]);